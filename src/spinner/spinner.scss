
/* =========================================================================
 * Svelto - Spinner
 * =========================================================================
 * Copyright (c) 2015-2016 Fabio Spampinato
 * Licensed under MIT (https://github.com/svelto/svelto/blob/master/LICENSE)
 * =========================================================================
 * Fork of http://codepen.io/Bodokh/pen/jEadzj - Eran Bodokh
 * =========================================================================
 * @require ../reset/reset.scss
 * @require ../widget/widget.scss
 * ========================================================================= */

//TODO: Add support for icon at the center of the spinner, sometimes might be useful

//FIXME: Firefox and Edge are not animating stroke-dashoffset, IE is not even animatin stroke-dasharray
//FIXME: Not working on Dolphin Browser

/* SPINNER */

svg.spinner {

  display: block;
  width: $spinner-size;
  height: $spinner-size;
  margin-bottom: $gutter;
  background-color: transparent !important;
  animation: rotate $spinner-animation-rotate-duration linear infinite;

  /* CIRCLE */

  circle {
    cx: $spinner-size / 2; // This only works on Chrome //TODO: Maybe just strip them off
    cy: $spinner-size / 2; // This only works on Chrome //TODO: Maybe just strip them off
    r: $spinner-radius; // This only works on Chrome //TODO: Maybe just strip them off
    fill: none;
    stroke-width: $spinner-stroke-width;
    stroke: $spinner-stroke-color;
    stroke-linecap: round;
    stroke-dasharray: 0%, 240%; // Since IE-10-11 won't animate this we are setting the initial value, so that it will degrade to a rotating dot
    animation: dash $spinner-stroke-animation-dash-duration ease-in-out infinite;
  }

  /* COLORS */

  @each $name, $datas in $colors {

    $bg: nth($datas, 1);

    &.#{$name} circle {
      stroke: $bg !important;
    }

  }

  /* MULTICOLOR */

  &.multicolor {

    /* CIRCLE */

    circle {
      animation: dash $spinner-stroke-animation-dash-duration ease-in-out infinite,
                 multicolor ( $spinner-stroke-animation-dash-duration * 4 ) ease-in-out infinite;
    }

  }

}

/* SPINNER LABEL */

.spinner-label {

  @extend .widget;
  @include color ( $spinner-label-color );
  @include z-depth ( $spinner-label-z-depth );
  display: flex;
  border-radius: $spinner-label-border-radius !important;
  padding: $spinner-label-padding-vertical $spinner-label-padding-horizontal;

  /* SPINNER */

  .spinner {
    margin-bottom: 0;
  }

  /* COLORS */

  @each $name, $datas in $colors {

    $accent: nth($datas, 5);

    &.#{$name} .spinner circle {
      stroke: $accent !important;
    }

  }

}

/* KEYFRAMES */

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 0%, 240%;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 181%, 240%;
    stroke-dashoffset: -60%;
  }
  100% {
    stroke-dasharray: 181%, 240%;
    stroke-dashoffset: -240%;
  }
}

@keyframes multicolor {
  0%, 24% {
    stroke: $spinner-multicolor-stroke-color1;
  }
  25%, 49% {
    stroke: $spinner-multicolor-stroke-color2;
  }
  50%, 74% {
    stroke: $spinner-multicolor-stroke-color3;
  }
  75%, 99% {
    stroke: $spinner-multicolor-stroke-color4;
  }
}
