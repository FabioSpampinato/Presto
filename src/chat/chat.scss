
/* =========================================================================
 * Svelto - Chat
 * =========================================================================
 * Copyright (c) 2015 Fabio Spampinato
 * Licensed under MIT (https://github.com/svelto/svelto/blob/master/LICENSE)
 * =========================================================================
 * @requires ../widget/widget.scss
 * ========================================================================= */

/* CHAT */

.chat-msg {

  @extend .widget;
  display: flex;

  /* IMAGE */

  .chat-msg-img {

    width: $chat-msg-img-size;
    height: $chat-msg-img-size;

    .image-wrp {

      transition: opacity $chat-msg-img-transition-duration;

      img {
        border-radius: 100%;
        width: $chat-msg-img-size;
        height: $chat-msg-img-size;
        border: $chat-msg-img-border-width solid $chat-msg-img-border-color;
      }

    }

    /* TIP */

    + .chat-msg-content .card-header:before {
      display: block;
    }

  }

  a.chat-msg-img:hover .image-wrp {
    opacity: $chat-msg-img-opacity-hover;
  }

  /* CONTENT */

  .chat-msg-content {

    flex-grow: 1;
    flex-shrink: 1; //INFO: IE-10-11 default it to 0 instead
    margin-bottom: 0;

    /* HEADER */

    .card-header {

      /* TIP */

      &:before {
        @include square ( $chat-tip-size, inherit );
        display: none;
        transform: rotate(45deg);
        position: absolute;
        content: '';
        z-index: 1;
        box-sizing: content-box;
        top: 50%;
      }

      /* TIP (OUTLINED) */

      &.outlined:before {
        border-width: $outline-width;
        border-style: solid;
        border-color: inherit;
      }

    }

  }

  /* NO TIP */

  &.no-tip {

    /* TIP */

    .chat-msg-content .card-header:before {
      display: none;
    }

  }

  /* LEFT */

  &:not(.direction-right) {

    /* LEVELS */

    &.level-3,
    &[class*='level-'] {
      margin-left: $chat-msg-level-3-spacing;
    }

    &.level-2 {
      margin-left: $chat-msg-level-2-spacing;
    }

    &.level-1 {
      margin-left: $chat-msg-level-1-spacing;
    }

    /* IMAGE */

    .chat-msg-img {
      order: 1;
      margin-right: calc(#{$gutter-half} + #{$chat-tip-size});
    }

    /* NO TIP */

    &.no-tip {

      /* IMAGE */

      .chat-msg-img{
        margin-right: $gutter;
      }

    }

    //INFO: No kind of usable clip-path property is supported by IE and Edge so we are just removing the tip, so we should also modify the spacing //FIXME: Not future proff, use feature detection instead

    _:-ms-lang(x), & .chat-msg-img {
      margin-right: $gutter;
    }

    /* CONTENT */

    .chat-msg-content {
      order: 2;
    }

    /* HEADER */

    .card-header {

      /* TIP */

      &:before {
        left: - ( $dropdown-tip-size / 2 );
        margin-top: - ( $dropdown-tip-size / 2 );
        clip-path: url('#{$basepath}chat-clips.svg#clip-right'); //INFO: The polygon is not supported on Firefox
        clip-path: polygon(0 0, 100% 100%, 0 100%);
      }

      //INFO: No kind of usable clip-path property is supported by IE and Edge so we are just removing the tip //FIXME: Not future proff, use feature detection instead

      _:-ms-lang(x), &:before {
        display: none !important;
      }


      /* TIP (OUTLINED) */

      &.outlined:before {
        margin-left: - $outline-width;
      }

    }

  }

  /* RIGHT */

  &.direction-right {

    /* LEVELS */

    &.level-3,
    &[class*='level-'] {
      margin-right: $chat-msg-level-3-spacing;
    }

    &.level-2 {
      margin-right: $chat-msg-level-2-spacing;
    }

    &.level-1 {
      margin-right: $chat-msg-level-1-spacing;
    }

    /* IMAGE */

    .chat-msg-img {
      order: 2;
      margin-left: calc(#{$gutter-half} + #{$chat-tip-size});
    }

    /* NO TIP */

    &.no-tip {

      /* IMAGE */

      .chat-msg-img{
        margin-left: $gutter;
      }

    }

    //INFO: No kind of usable clip-path property is supported by IE and Edge so we are just removing the tip, so we should also modify the spacing //FIXME: Not future proff, use feature detection instead

    _:-ms-lang(x), & .chat-msg-img {
      margin-left: $gutter;
    }

    /* CONTENT */

    .chat-msg-content {
      order: 1;
    }

    /* HEADER */

    .card-header {

      /* TIP */

      &:before {
        right: - ( $dropdown-tip-size / 2 );
        margin-top: - ( $dropdown-tip-size / 2 );
        clip-path: url('#{$basepath}chat-clips.svg#clip-left'); //INFO: The polygon is not supported on Firefox
        clip-path: polygon(0 0, 100% 100%, 100% 0);
      }

      //INFO: No kind of usable clip-path property is supported by IE and Edge so we are just removing the tip //FIXME: Not future proff, use feature detection instead

      _:-ms-lang(x), &:before {
        display: none !important;
      }

      /* TIP (OUTLINED) */

      &.outlined:before {
        margin-right: - $outline-width;
      }

    }

  }

}
