
/* =========================================================================
 * Svelto - Panel
 * =========================================================================
 * Copyright (c) 2015 Fabio Spampinato
 * Licensed under MIT (https://github.com/svelto/svelto/blob/master/LICENSE)
 * ========================================================================= */

//INFO: The `attached-*` panel must be placed before the header tag, otherwise the CSS selectors will not work
//TODO: Add a class that makes the panel stays below the toolbar, in that case the toolbar should have an higher z-index than the panel probably, or maybe pulling it down it's enough (probably not since the background is much larger than the visible part)

//TODO: Not working on Dolphin browser
//FIXME: Not working on iPod's Safari

/* MIXINS */

@mixin show () {
  display: flex !important;
}

@mixin open () {

  transform: translateX(0) translateY(0) !important;

  /* BEFORE (BACKGROUND) */

  &:before {
    opacity: 1;
  }

}

@mixin attach () {

  @include z-depth ( $panel-attached-z-depth );

  /* BEFORE (BACKGROUND) */

  &:before {
    display: none;
    opacity: 0;
  }

  /* LEFT */

  &.left,
  &:not(.right):not(.top):not(.bottom) { //INFO: Default case

    /* CONTENT */

    ~ #content {

      margin-left: $panel-vertical-width;

      /* HEADER */

      > header.fixed {
        left: $panel-vertical-width;
      }

    }

    /* SLIM */

    &.slim {

      /* CONTENT */

      ~ #content {

        margin-left: $panel-slim-vertical-width;

        /* HEADER */

        > header.fixed {
          left: $panel-slim-vertical-width;
        }

      }

    }

  }

  /* RIGHT */

  &.right {

    /* CONTENT */

    ~ #content {

      margin-right: $panel-vertical-width;

      /* HEADER */

      > header.fixed {
        right: $panel-vertical-width;
      }

    }

    /* SLIM */

    &.slim {

      /* CONTENT */

      ~ #content {

        margin-right: $panel-slim-vertical-width;

        /* HEADER */

        > header.fixed {
          right: $panel-slim-vertical-width;
        }

      }

    }

  }

  /* TOP */

  &.top {

    /* CONTENT */

    ~ #content {

      margin-top: $panel-horizontal-height;

      /* HEADER */

      > header.fixed {
        top: $panel-horizontal-height;
      }

    }

    /* SLIM */

    &.slim {

      /* CONTENT */

      ~ #content {

        margin-top: $panel-slim-horizontal-height;

        /* HEADER */

        > header.fixed {
          top: $panel-slim-horizontal-height;
        }

      }

    }

  }

  /* BOTTOM */

  &.bottom {

    /* CONTENT */

    ~ #content {

      margin-bottom: $panel-horizontal-height;

      /* HEADER */

      > header.fixed {
        bottom: $panel-horizontal-height;
      }

    }

    /* SLIM */

    &.slim {

      /* CONTENT */

      ~ #content {

        margin-bottom: $panel-slim-horizontal-height;

        /* HEADER */

        > header.fixed {
          bottom: $panel-slim-horizontal-height;
        }

      }

    }

  }

}

/* PANEL */

.panel {

  @include z-depth ( $panel-z-depth );
  display: none;
  position: fixed;
  z-index: $panel-z-index;
  margin-bottom: 0;
  border-radius: 0;
  transition: transform $panel-transition-transform-duration;
  overflow: visible !important; //INFO: Since we need the pseudo element to be showed

  /* LEFT / RIGHT */

  &.left,
  &.right,
  &:not(.top):not(.bottom) { //INFO: Default case

    top: 0;
    bottom: 0;
    width: $panel-vertical-width;

    /* SLIM */

    &.slim {
      width: $panel-slim-vertical-width;
    }

  }

  /* LEFT */

  &.left,
  &:not(.right):not(.top):not(.bottom) { //INFO: Default case

    left: 0;
    transform: translateX(- $panel-closed-vertical-spacing);

    /* SLIM */

    &.slim {
      transform: translateX(- $panel-slim-closed-vertical-spacing);
    }

  }

  /* RIGHT */

  &.right {

    right: 0;
    transform: translateX($panel-closed-vertical-spacing);

    /* SLIM */

    &.slim {
      transform: translateX($panel-slim-closed-vertical-spacing);
    }

  }

  /* TOP / BOTTOM */

  &.top,
  &.bottom {

    right: 0;
    left: 0;
    height: $panel-horizontal-height;

    /* SLIM */

    &.slim {
      height: $panel-slim-horizontal-height;
    }

  }

  /* TOP */

  &.top {

    top: 0;
    transform: translateY(- $panel-closed-horizontal-spacing);

    /* SLIM */

    &.slim {
      transform: translateY(- $panel-slim-closed-horizontal-spacing);
    }

  }

  /* BOTTOM */

  &.bottom {

    bottom: 0;
    transform: translateY($panel-closed-horizontal-spacing);

    /* SLIM */

    &.slim {
      transform: translateY($panel-slim-closed-horizontal-spacing);
    }

  }

  /* SHOW */

  &.show {
    @include show ();
  }

  /* OPEN */

  &.open {
    @include show ();
    @include open ();
  }

  /* ATTACHED */

  &.attached {
    @include show ();
    @include open ();
    @include attach ();
  }

  @include xsmall-up {

    &.attached-xs {
      @include show ();
      @include open ();
      @include attach ();
    }

  }

  @include small-up {

    &.attached-sm {
      @include show ();
      @include open ();
      @include attach ();
    }

  }

  @include medium-up {

    &.attached-md {
      @include show ();
      @include open ();
      @include attach ();
    }

  }

  @include large-up {

    &.attached-lg {
      @include show ();
      @include open ();
      @include attach ();
    }

  }

  @include xlarge-up {

    &.attached-xl {
      @include show ();
      @include open ();
      @include attach ();
    }

  }

  /* BEFORE (BACKGROUND) */

  &:before {
    content: '';
    position: absolute;
    opacity: 0;
    width: 400vw;
    height: 400vh;
    top: -200vh;
    left: -200vw;
    z-index: -1;
    cursor: pointer;
    background-color: $panel-background-color;
    transition: opacity $panel-background-transition-opacity-duration;
  }

}
