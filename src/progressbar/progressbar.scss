
/* =========================================================================
 * Svelto - Progressbar
 * =========================================================================
 * Copyright (c) 2015 Fabio Spampinato
 * Licensed under MIT (https://github.com/svelto/svelto/blob/master/LICENSE)
 * =========================================================================
 * @requires ../widget/widget.scss
 * ========================================================================= */

//TODO: Add support for vertical progressbar (not particularly useful, but when attached it will be an appropriate example of horizontally attached widget)

/* PROGRESSBAR */

.progressbar {

  @extend .widget;
  @include color ( $progressbar-color );
  display: flex;
  overflow: hidden;
  height: $progressbar-height;
  border-radius: $progressbar-border-radius;
  transform: translateZ(0); //INFO: Fixes an overflowing bug, it happens only on helpers -> attached as far as I could see

  /* HIGHLIGHT */

  &-highlight {
    @include color ( $progressbar-highlight-color );
    @include text-truncate ();
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: min-width $progressbar-transition-all-duration;
  }

  /* LABELED */

  &.labeled {

    /* AFTER (LABEL) */

    .progressbar-highlight:after {
      content: attr(data-value);
      font-size: $progressbar-label-font-size;
      padding: 0 $gutter-half;
    }

  }

  /* STRIPED */

  &.striped {

    .progressbar-highlight:before {
      position: absolute;
      top: 0;
      bottom: 0;
      left: - $progressbar-stripe-size;
      right: - $progressbar-stripe-size;
      background: linear-gradient(-45deg, $progressbar-stripe-light-color 25%, $progressbar-stripe-dark-color 25%, $progressbar-stripe-dark-color 50%, $progressbar-stripe-light-color 50%, $progressbar-stripe-light-color 75%, $progressbar-stripe-dark-color 75%, $progressbar-stripe-dark-color);
      content: '';
      pointer-events: none;
      background-size: $progressbar-stripe-size $progressbar-stripe-size;
    }

    &:not(.disabled) .progressbar-highlight:before {
      animation: progressbar-stripes-move $progressbar-stripes-transition-move-duration linear infinite;
    }

  }

  /* INDETERMINATE */

  &.indeterminate {

    .progressbar-highlight {

      animation: progressbar-indeterminate-highlight $progressbar-indeterminate-animation-duration linear infinite;

      /* STRIPES / LABEL */

      &:before,
      &:after {
        display: none;
      }

    }

  }

  /* COMPACT */

  &.compact {

    height: $progressbar-compact-height;

    /* AFTER (LABEL) */

    .progressbar-highlight:after {
      font-size: $progressbar-compact-label-font-size;
    }

  }

  /* SLIM */

  &.slim {

    height: $progressbar-slim-height;

    /* AFTER (LABEL) */

    .progressbar-highlight:after {
      font-size: $progressbar-slim-label-font-size;
    }

  }

}

/* KEYFRAMES */

@keyframes progressbar-stripes-move {
  0% {
    transform: translateX(0);
  }
  100% {
    transform: translateX($progressbar-stripe-size);
  }
}

@keyframes progressbar-indeterminate-highlight {
  0% {
    width: 100%;
    transform: translateX(-60%) scaleX(0.15);
  }
  35% {
    transform: translateX(-15%) scaleX(0.5);
  }
  100% {
    width: 100%;
    transform: translateX(51%) scaleX(0.05);
  }
}
